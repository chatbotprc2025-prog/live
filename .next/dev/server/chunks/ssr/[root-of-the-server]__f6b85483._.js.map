{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/TECHNOSOFT/Downloads/test-main/PCE_Assistant-main/app/chat/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Message {\r\n  id: string;\r\n  sender: 'user' | 'assistant';\r\n  content: string;\r\n  createdAt: string;\r\n  images?: Array<{\r\n    url: string;\r\n    description?: string;\r\n    title?: string;\r\n  }>;\r\n}\r\n\r\ninterface Conversation {\r\n  id: string;\r\n  title: string;\r\n  updatedAt: string;\r\n  messages?: Message[];\r\n}\r\n\r\ninterface Source {\r\n  title: string;\r\n  snippet: string;\r\n  documentId?: string;\r\n}\r\n\r\n/**\r\n * Format message content for better readability\r\n */\r\nfunction formatMessageContent(content: string) {\r\n  // Split by double newlines (paragraphs)\r\n  const paragraphs = content.split(/\\n\\n+/).filter(p => p.trim());\r\n  \r\n  return paragraphs.map((paragraph, idx) => {\r\n    const trimmed = paragraph.trim();\r\n    \r\n    // Check if it's a list (starts with -, *, or number)\r\n    if (/^[-*‚Ä¢]\\s/.test(trimmed) || /^\\d+[.)]\\s/.test(trimmed)) {\r\n      const listItems = trimmed.split(/\\n(?=[-*‚Ä¢\\d])/).filter(item => item.trim());\r\n      return (\r\n        <ul key={idx} className=\"list-none space-y-1.5 my-2 pl-0\">\r\n          {listItems.map((item, itemIdx) => {\r\n            const cleanItem = item.replace(/^[-*‚Ä¢]\\s|^\\d+[.)]\\s/, '').trim();\r\n            return (\r\n              <li key={itemIdx} className=\"flex items-start gap-2\">\r\n                <span className=\"text-charcoal/60 mt-1.5 shrink-0\">‚Ä¢</span>\r\n                <span className=\"flex-1\">{cleanItem}</span>\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n      );\r\n    }\r\n    \r\n    // Regular paragraph\r\n    const lines = trimmed.split('\\n').filter(line => line.trim());\r\n    return (\r\n      <p key={idx} className=\"mb-2 last:mb-0\">\r\n        {lines.map((line, lineIdx) => (\r\n          <span key={lineIdx}>\r\n            {line.trim()}\r\n            {lineIdx < lines.length - 1 && <br className=\"mb-1\" />}\r\n          </span>\r\n        ))}\r\n      </p>\r\n    );\r\n  });\r\n}\r\nexport default function ChatPage() {\r\n  const [conversations, setConversations] = useState<Conversation[]>([]);\r\n  const [filteredConversations, setFilteredConversations] = useState<Conversation[]>([]);\r\n  const [activeConversation, setActiveConversation] = useState<Conversation | null>(null);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [inputMessage, setInputMessage] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [sources, setSources] = useState<Source[]>([]);\r\n  const [showPolicyBanner, setShowPolicyBanner] = useState(true);\r\n  const [isAuthorized, setIsAuthorized] = useState(false);\r\n  const [deletingConversationId, setDeletingConversationId] = useState<string | null>(null);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [clientUser, setClientUser] = useState<{ email: string; userType: string } | null>(null);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    // Check if user has registered before allowing access to chat\r\n    const isLoggedIn = localStorage.getItem('clientUserLoggedIn');\r\n    const clientUserId = localStorage.getItem('clientUserId');\r\n    const clientUserEmail = localStorage.getItem('clientUserEmail') || '';\r\n    const clientUserType = localStorage.getItem('clientUserType') || 'student';\r\n    \r\n    // Redirect to login if not logged in or missing required data\r\n    if (isLoggedIn !== 'true' || !clientUserId) {\r\n      localStorage.removeItem('clientUserLoggedIn');\r\n      localStorage.removeItem('clientUserId');\r\n      localStorage.removeItem('clientUserType');\r\n      localStorage.removeItem('clientUserEmail');\r\n      router.push('/');\r\n      return;\r\n    }\r\n    setIsAuthorized(true);\r\n    setClientUser({ email: clientUserEmail, userType: clientUserType });\r\n    loadConversations();\r\n  }, [router]);\r\n\r\n  // Filter conversations based on search query\r\n  useEffect(() => {\r\n    if (!searchQuery.trim()) {\r\n      setFilteredConversations(conversations);\r\n    } else {\r\n      const query = searchQuery.toLowerCase();\r\n      const filtered = conversations.filter((conv) =>\r\n        conv.title.toLowerCase().includes(query)\r\n      );\r\n      setFilteredConversations(filtered);\r\n    }\r\n  }, [searchQuery, conversations]);\r\n\r\n  useEffect(() => {\r\n    if (activeConversation) {\r\n      loadConversationMessages(activeConversation.id);\r\n    }\r\n  }, [activeConversation]);\r\n\r\n  useEffect(() => {\r\n    // Scroll to bottom when messages change\r\n    const timeoutId = setTimeout(() => {\r\n      scrollToBottom();\r\n    }, 150);\r\n    return () => clearTimeout(timeoutId);\r\n  }, [messages, isLoading]);\r\n\r\n  const scrollToBottom = () => {\r\n    // Use requestAnimationFrame for better timing\r\n    requestAnimationFrame(() => {\r\n      const container = messagesContainerRef.current;\r\n      if (container) {\r\n        // Scroll to bottom immediately\r\n        container.scrollTop = container.scrollHeight;\r\n      }\r\n      // Also try the ref method as fallback\r\n      if (messagesEndRef.current) {\r\n        messagesEndRef.current.scrollIntoView({ behavior: 'smooth', block: 'end' });\r\n      }\r\n    });\r\n  };\r\n\r\n  const loadConversations = async () => {\r\n    try {\r\n      const res = await fetch('/api/conversations');\r\n      const data = await res.json();\r\n      const list = Array.isArray(data) ? data : [];\r\n      setConversations(list);\r\n      setFilteredConversations(list);\r\n      if (list.length > 0 && !activeConversation) {\r\n        setActiveConversation(list[0]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load conversations:', error);\r\n    }\r\n  };\r\n\r\n  const handleDeleteConversation = async (conversationId: string) => {\r\n    const confirmed = window.confirm('Delete this conversation? This cannot be undone.');\r\n    if (!confirmed) return;\r\n\r\n    try {\r\n      setDeletingConversationId(conversationId);\r\n      const res = await fetch(`/api/conversations/${conversationId}`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => ({ error: 'Failed to delete conversation' }));\r\n        throw new Error(errorData.error || `Server error: ${res.status}`);\r\n      }\r\n\r\n      setConversations((prev) => {\r\n        const updated = prev.filter((conv) => conv.id !== conversationId);\r\n        const deletedActive = activeConversation?.id === conversationId;\r\n\r\n        if (deletedActive) {\r\n          const nextActive = updated[0] || null;\r\n          setActiveConversation(nextActive);\r\n\r\n          if (nextActive) {\r\n            loadConversationMessages(nextActive.id);\r\n          } else {\r\n            setMessages([]);\r\n            setSources([]);\r\n          }\r\n        }\r\n\r\n        return updated;\r\n      });\r\n      // Refresh from server to keep ordering/metadata in sync\r\n      loadConversations();\r\n    } catch (error: any) {\r\n      console.error('Failed to delete conversation:', error);\r\n      alert(error.message || 'Failed to delete conversation. Please try again.');\r\n    } finally {\r\n      setDeletingConversationId(null);\r\n    }\r\n  };\r\n\r\n  const loadConversationMessages = async (conversationId: string) => {\r\n    try {\r\n      const res = await fetch(`/api/conversations/${conversationId}`);\r\n      const data = await res.json();\r\n      \r\n      // Process messages to ensure images are properly formatted\r\n      const processedMessages = (data.messages || []).map((msg: any) => {\r\n        let images = undefined;\r\n        \r\n        // Handle images - could be array (from API) or string (from DB that needs parsing)\r\n        if (msg.images) {\r\n          if (typeof msg.images === 'string') {\r\n            try {\r\n              images = JSON.parse(msg.images);\r\n            } catch (e) {\r\n              console.warn('Failed to parse images JSON:', e);\r\n              images = undefined;\r\n            }\r\n          } else if (Array.isArray(msg.images)) {\r\n            images = msg.images;\r\n          }\r\n          \r\n          // Filter valid images\r\n          if (images && Array.isArray(images) && images.length > 0) {\r\n            images = images.filter((img: any) => img && img.url && typeof img.url === 'string' && img.url.trim().length > 0);\r\n            if (images.length === 0) {\r\n              images = undefined;\r\n            }\r\n          } else {\r\n            images = undefined;\r\n          }\r\n        }\r\n        \r\n        return {\r\n          ...msg,\r\n          images,\r\n        };\r\n      });\r\n      \r\n      console.log('üì• Loaded messages with images:', processedMessages.filter((m: any) => m.images).length);\r\n      setMessages(processedMessages);\r\n      setSources([]);\r\n      // Scroll to bottom after loading messages\r\n      setTimeout(() => scrollToBottom(), 300);\r\n    } catch (error) {\r\n      console.error('Failed to load messages:', error);\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!inputMessage.trim() || isLoading) return;\r\n\r\n    const userMessage = inputMessage.trim();\r\n    setInputMessage('');\r\n    setIsLoading(true);\r\n\r\n    // Add user message to UI immediately\r\n    const tempUserMessage: Message = {\r\n      id: `temp-${Date.now()}`,\r\n      sender: 'user',\r\n      content: userMessage,\r\n      createdAt: new Date().toISOString(),\r\n    };\r\n    setMessages(prev => [...prev, tempUserMessage]);\r\n\r\n    // Scroll after adding user message\r\n    setTimeout(() => scrollToBottom(), 100);\r\n\r\n    try {\r\n      const res = await fetch('/api/chat', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          message: userMessage,\r\n          conversationId: activeConversation?.id,\r\n        }),\r\n      });\r\n\r\n       if (!res.ok) {\r\n        const errorData = await res.json().catch(() => ({ error: 'Failed to get response' }));\r\n        throw new Error(errorData.error || `Server error: ${res.status}`);\r\n      }\r\n\r\n      const data = await res.json();\r\n\r\n      if (!data.answer) {\r\n        throw new Error('No answer received from server');\r\n      }\r\n\r\n      // Remove temp user message and add real one\r\n      setMessages(prev => prev.filter(m => m.id !== tempUserMessage.id));\r\n      \r\n      // Add user message back (will be saved by API)\r\n      setMessages(prev => [...prev, tempUserMessage]);\r\n\r\n      // Add assistant response with images if available\r\n      console.log('Received data from API:', { \r\n        hasAnswer: !!data.answer, \r\n        hasImages: !!data.images, \r\n        imageCount: data.images?.length || 0,\r\n        images: data.images \r\n      });\r\n      \r\n      // Process images to ensure they're valid\r\n      let processedImages = undefined;\r\n      if (data.images && Array.isArray(data.images) && data.images.length > 0) {\r\n        processedImages = data.images\r\n          .filter((img: any) => {\r\n            const isValid = img && img.url && typeof img.url === 'string' && img.url.trim().length > 0;\r\n            if (!isValid) {\r\n              console.warn('Invalid image object filtered out:', img);\r\n            }\r\n            return isValid;\r\n          })\r\n          .map((img: any) => ({\r\n            url: img.url.trim(),\r\n            description: img.description || img.title || undefined,\r\n            title: img.title || undefined,\r\n          }));\r\n        if (processedImages.length === 0) {\r\n          processedImages = undefined;\r\n        } else {\r\n          console.log('‚úÖ Processed images for display:', processedImages);\r\n        }\r\n      } else {\r\n        console.log('‚ö†Ô∏è No images in response or empty array');\r\n      }\r\n      \r\n      const assistantMessage: Message = {\r\n        id: `msg-${Date.now()}`,\r\n        sender: 'assistant',\r\n        content: data.answer || 'Sorry, I could not generate a response. Please try again.',\r\n        createdAt: new Date().toISOString(),\r\n        images: processedImages,\r\n      };\r\n      \r\n      console.log('üìù Assistant message created:', {\r\n        hasImages: !!assistantMessage.images,\r\n        imageCount: assistantMessage.images?.length || 0,\r\n        messageId: assistantMessage.id,\r\n        images: assistantMessage.images,\r\n      });\r\n      \r\n      // Add message with images - ensure images persist\r\n      setMessages(prev => {\r\n        const updated = [...prev, assistantMessage];\r\n        console.log('üìã Messages after adding:', updated.length, 'messages, last one has images:', !!updated[updated.length - 1].images);\r\n        return updated;\r\n      });\r\n\r\n      // Set sources if available\r\n       if (data.sources && Array.isArray(data.sources)) {\r\n        setSources(data.sources);\r\n      } else {\r\n        setSources([]);\r\n      }\r\n\r\n      // Ensure scroll happens after message is added\r\n      setTimeout(() => scrollToBottom(), 300);\r\n\r\n       // Update active conversation\r\n      if (data.conversationId) {\r\n        const updatedConv: Conversation = {\r\n          id: data.conversationId,\r\n          title: activeConversation?.title || userMessage.substring(0, 50),\r\n          updatedAt: new Date().toISOString(),\r\n        };\r\n        setActiveConversation(updatedConv);\r\n        loadConversations();\r\n      }\r\n     } catch (error: any) {\r\n      console.error('Failed to send message:', error);\r\n      \r\n      // Remove temp user message on error\r\n      setMessages(prev => prev.filter(m => m.id !== tempUserMessage.id));\r\n      \r\n      // Add error message\r\n      const errorMessage: Message = {\r\n        id: `error-${Date.now()}`,\r\n        sender: 'assistant',\r\n        content: `Sorry, I encountered an error: ${error.message || 'Unknown error'}. Please try again.`,\r\n        createdAt: new Date().toISOString(),\r\n      };\r\n      setMessages(prev => [...prev, errorMessage]);\r\n      setTimeout(() => scrollToBottom(), 200);\r\n     } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSuggestionClick = (suggestion: string) => {\r\n    setInputMessage(suggestion);\r\n  };\r\n\r\n  const handleNewConversation = async () => {\r\n    try {\r\n      const res = await fetch('/api/conversations', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          title: 'New Conversation',\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        throw new Error('Failed to create conversation');\r\n      }\r\n\r\n      const newConversation = await res.json();\r\n      \r\n      // Clear current messages\r\n      setMessages([]);\r\n      setSources([]);\r\n      \r\n      // Set new conversation as active\r\n      setActiveConversation(newConversation);\r\n      \r\n      // Reload conversations list\r\n      await loadConversations();\r\n    } catch (error: any) {\r\n      console.error('Failed to create conversation:', error);\r\n      alert(error.message || 'Failed to create new conversation. Please try again.');\r\n    }\r\n  };\r\n\r\n  const quickLinks = [\r\n    { icon: 'school', label: 'Academics' },\r\n    { icon: 'calendar_month', label: 'Timetable' },\r\n    { icon: 'receipt_long', label: 'Fees' },\r\n    { icon: 'local_library', label: 'Library' },\r\n    { icon: 'map', label: 'Campus Map' },\r\n    { icon: 'contacts', label: 'Contacts' },\r\n  ];\r\n\r\n  if (!isAuthorized) {\r\n    return (\r\n      <div className=\"flex h-screen w-full items-center justify-center\" style={{ background: 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)' }}>\r\n        <div className=\"text-center\">\r\n          <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary mb-4\"></div>\r\n          <p className=\"text-gray-700 font-medium\">Checking registration...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex h-screen w-full relative overflow-hidden\" style={{ background: 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)' }}>\r\n      {/* Left Sidebar - Conversations - Glassmorphic */}\r\n      <aside className=\"hidden lg:flex w-[320px] flex-col glass-card border-r\" style={{ background: 'rgba(255, 255, 255, 0.25)', backdropFilter: 'blur(20px)', borderColor: 'rgba(255, 255, 255, 0.18)' }}>\r\n        <div className=\"shrink-0 p-4\">\r\n          <div className=\"flex items-center gap-3 px-2 pt-2 pb-4\">\r\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-2xl relative overflow-hidden animate-float\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', boxShadow: '0 8px 30px rgba(102, 126, 234, 0.4)' }}>\r\n              <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent\"></div>\r\n              <p className=\"text-xl font-bold text-white relative z-10\">PCE</p>\r\n            </div>\r\n            <p className=\"text-charcoal text-lg font-bold gradient-text\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent' }}>PCE Assistant</p>\r\n          </div>\r\n          <div className=\"relative\">\r\n            <span className=\"material-symbols-outlined pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-charcoal/60 z-10\">\r\n              search\r\n            </span>\r\n            <input\r\n              className=\"modern-input w-full rounded-2xl py-3 pl-10 pr-4 text-sm text-charcoal placeholder-charcoal/60\"\r\n              placeholder=\"Search conversations...\"\r\n              type=\"text\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"flex-1 space-y-4 overflow-y-auto px-4\">\r\n          <div>\r\n            <div className=\"flex items-center justify-between px-2 mb-2\">\r\n              <h3 className=\"text-xs font-semibold uppercase tracking-wider text-charcoal/50\">\r\n                Conversations\r\n              </h3>\r\n              <button\r\n                onClick={handleNewConversation}\r\n                className=\"flex items-center justify-center w-7 h-7 rounded-full text-white shadow-md hover:shadow-lg transition-all duration-200 hover:scale-110\"\r\n                style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', boxShadow: '0 4px 15px rgba(102, 126, 234, 0.4)' }}\r\n                title=\"New Conversation\"\r\n              >\r\n                <span className=\"material-symbols-outlined text-base\">add</span>\r\n              </button>\r\n            </div>\r\n            <ul className=\"flex flex-col gap-1\">\r\n              {filteredConversations.length === 0 && searchQuery ? (\r\n                <li className=\"px-3 py-4 text-sm text-charcoal/60 text-center\">\r\n                  No conversations found matching \"{searchQuery}\"\r\n                </li>\r\n              ) : (\r\n                filteredConversations.map((conv) => (\r\n                <li\r\n                  key={conv.id}\r\n                  onClick={() => setActiveConversation(conv)}\r\n                  className={`flex h-12 cursor-pointer items-center gap-3 rounded-xl px-3 transition-all hover-lift ${\r\n                    activeConversation?.id === conv.id\r\n                      ? 'neu-card-inset'\r\n                      : 'hover:bg-white/20'\r\n                  }`}\r\n                  style={activeConversation?.id === conv.id ? { background: 'rgba(102, 126, 234, 0.15)', boxShadow: 'inset 4px 4px 8px rgba(163, 177, 198, 0.2), inset -4px -4px 8px rgba(255, 255, 255, 0.8)' } : {}}\r\n                >\r\n                  <span\r\n                    className={`material-symbols-outlined text-[22px] ${\r\n                      activeConversation?.id === conv.id ? 'text-primary' : 'text-charcoal/80'\r\n                    }`}\r\n                  >\r\n                    chat_bubble\r\n                  </span>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <p\r\n                      className={`text-sm leading-tight truncate ${\r\n                        activeConversation?.id === conv.id\r\n                          ? 'text-primary font-semibold'\r\n                          : 'text-charcoal font-medium'\r\n                      }`}\r\n                    >\r\n                      {conv.title}\r\n                    </p>\r\n                  </div>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleDeleteConversation(conv.id);\r\n                    }}\r\n                    disabled={deletingConversationId === conv.id}\r\n                    className=\"flex size-8 items-center justify-center rounded-lg transition-colors hover:bg-white/30 text-charcoal/70 disabled:opacity-50\"\r\n                    title=\"Delete conversation\"\r\n                  >\r\n                    <span className=\"material-symbols-outlined text-[18px]\">delete</span>\r\n                  </button>\r\n                </li>\r\n                ))\r\n              )}\r\n            </ul>\r\n          </div>\r\n          <div>\r\n            <h3 className=\"px-2 text-xs font-semibold uppercase tracking-wider text-charcoal/50 mb-2\">\r\n              Quick Links\r\n            </h3>\r\n            <ul className=\"flex flex-col gap-1\">\r\n              {quickLinks.map((link) => (\r\n                <li\r\n                  key={link.label}\r\n                  className=\"flex h-12 cursor-pointer items-center gap-3 rounded-xl px-3 transition-all hover-lift hover:bg-white/20\"\r\n                >\r\n                  <span className=\"material-symbols-outlined text-charcoal/80 text-[22px]\">\r\n                    {link.icon}\r\n                  </span>\r\n                  <p className=\"text-charcoal text-sm font-medium leading-tight truncate\">\r\n                    {link.label}\r\n                  </p>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n        {/* User Info Card and Settings Button */}\r\n        <div className=\"p-4 border-t\" style={{ borderColor: 'rgba(255, 255, 255, 0.18)' }}>\r\n          <div className=\"mb-3 p-3 rounded-xl glass-card\" style={{ background: 'rgba(255, 255, 255, 0.2)', backdropFilter: 'blur(10px)' }}>\r\n            <p className=\"text-xs text-gray-500 mb-1\">Logged in as</p>\r\n            <p className=\"text-sm font-semibold text-charcoal truncate\">{clientUser?.email || 'Student'}</p>\r\n            {clientUser?.userType && (\r\n              <p className=\"text-xs text-gray-500 mt-1 capitalize\">{clientUser.userType}</p>\r\n            )}\r\n          </div>\r\n          <Link\r\n            href=\"/settings\"\r\n            className=\"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-sm font-semibold text-white hover-lift transition-all\"\r\n            style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', boxShadow: '0 4px 15px rgba(102, 126, 234, 0.3)' }}\r\n          >\r\n            <span className=\"material-symbols-outlined text-lg\">settings</span>\r\n            <span>Settings</span>\r\n          </Link>\r\n        </div>\r\n      </aside>\r\n\r\n      {/* Main Chat Area */}\r\n      <div className=\"flex flex-1 flex-col relative\">\r\n        <header className=\"flex shrink-0 items-center justify-between glass-card p-4\" style={{ background: 'rgba(255, 255, 255, 0.3)', backdropFilter: 'blur(20px)', borderBottom: '1px solid rgba(255, 255, 255, 0.18)' }}>\r\n          <button className=\"flex size-10 items-center justify-center text-charcoal lg:hidden\">\r\n            <span className=\"material-symbols-outlined text-2xl\">menu</span>\r\n          </button>\r\n          <h1 className=\"text-charcoal text-lg font-bold leading-tight gradient-text\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent' }}>\r\n            {activeConversation?.title || 'Campus Assistant'}\r\n          </h1>\r\n          <div className=\"w-12\" />\r\n        </header>\r\n\r\n        <main\r\n          ref={messagesContainerRef}\r\n           className=\"flex-1 overflow-y-auto p-4 pb-24 space-y-6 scroll-smooth\"\r\n          style={{ \r\n            maxHeight: 'calc(100vh - 140px)',\r\n            scrollBehavior: 'smooth',\r\n            WebkitOverflowScrolling: 'touch'\r\n          }}\r\n         >\r\n          {showPolicyBanner && (\r\n            <div className=\"flex items-center justify-between rounded-2xl glass-card p-4 animate-slide-up\" style={{ background: 'rgba(255, 255, 255, 0.4)', backdropFilter: 'blur(15px)', border: '1px solid rgba(255, 255, 255, 0.3)' }}>\r\n              <div className=\"flex flex-col gap-1\">\r\n                <p className=\"text-charcoal text-sm font-semibold leading-tight\">\r\n                  Policy Information\r\n                </p>\r\n                <p className=\"text-gray-500 text-sm font-normal leading-normal\">\r\n                  Your conversations help improve our service. Please don't share personal information.\r\n                </p>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowPolicyBanner(false)}\r\n                className=\"text-sm font-medium leading-normal text-gray-500 hover:text-charcoal\"\r\n              >\r\n                Dismiss\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {messages.length === 0 && (\r\n            <div className=\"flex items-end gap-3 animate-fade-in\">\r\n              <div className=\"bg-center bg-no-repeat aspect-square bg-cover rounded-full w-12 shrink-0 relative overflow-hidden animate-float flex items-center justify-center\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', boxShadow: '0 8px 30px rgba(102, 126, 234, 0.4)' }}>\r\n                <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent\"></div>\r\n                <span className=\"material-symbols-outlined text-white relative z-10 text-2xl\">support_agent</span>\r\n              </div>\r\n              <div className=\"flex flex-1 flex-col gap-1.5 items-start\">\r\n                <p className=\"text-charcoal/70 text-[13px] font-medium leading-normal max-w-[360px]\">\r\n                  Campus Assistant\r\n                </p>\r\n                <div className=\"flex flex-col gap-2 items-start\">\r\n                  <p className=\"chat-bubble-assistant text-base font-normal leading-normal flex max-w-[360px] rounded-2xl rounded-bl-none px-5 py-4 text-charcoal\">\r\n                    Hello! I'm the PCE Campus Assistant. How can I help you today? You can ask me about library hours, fee deadlines, and more.\r\n                  </p>\r\n                  <div className=\"flex flex-wrap gap-2 pt-1\">\r\n                    <button\r\n                      onClick={() => handleSuggestionClick('What are the library hours?')}\r\n                      className=\"rounded-xl glass-card px-4 py-2 text-sm text-charcoal hover-lift transition-all\"\r\n                      style={{ background: 'rgba(255, 255, 255, 0.3)', backdropFilter: 'blur(10px)' }}\r\n                    >\r\n                      What are the library hours?\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleSuggestionClick('When is the fee deadline?')}\r\n                      className=\"rounded-xl glass-card px-4 py-2 text-sm text-charcoal hover-lift transition-all\"\r\n                      style={{ background: 'rgba(255, 255, 255, 0.3)', backdropFilter: 'blur(10px)' }}\r\n                    >\r\n                      When is the fee deadline?\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {messages.map((message) => (\r\n            <div\r\n              key={message.id}\r\n              className={`flex items-end gap-3 ${message.sender === 'user' ? 'justify-end' : ''}`}\r\n            >\r\n              {message.sender === 'assistant' && (\r\n                <div className=\"bg-center bg-no-repeat aspect-square bg-cover rounded-full w-12 shrink-0 relative overflow-hidden flex items-center justify-center\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', boxShadow: '0 8px 30px rgba(102, 126, 234, 0.3)' }}>\r\n                  <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent\"></div>\r\n                  <span className=\"material-symbols-outlined text-white relative z-10 text-xl\">support_agent</span>\r\n                </div>\r\n              )}\r\n              <div\r\n                className={`flex flex-1 flex-col gap-1.5 items-${message.sender === 'user' ? 'end' : 'start'}`}\r\n              >\r\n                <p\r\n                  className={`text-charcoal/70 text-[13px] font-medium leading-normal max-w-[360px] ${\r\n                    message.sender === 'user' ? 'text-right' : ''\r\n                  }`}\r\n                >\r\n                  {message.sender === 'user' ? 'You' : 'Campus Assistant'}\r\n                </p>\r\n                 <div\r\n                  className={`text-base font-normal leading-relaxed flex max-w-[360px] rounded-2xl px-5 py-4 shadow-soft animate-slide-up break-words ${\r\n                     message.sender === 'user'\r\n                      ? 'chat-bubble-user text-white rounded-br-none'\r\n                      : 'chat-bubble-assistant text-charcoal rounded-bl-none'\r\n                  }`}\r\n                   style={message.sender === 'user' ? { background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', boxShadow: '0 10px 40px rgba(102, 126, 234, 0.3)' } : { lineHeight: '1.7' }}\r\n                >\r\n                  <div className=\"w-full space-y-2.5\">\r\n                    {formatMessageContent(message.content)}\r\n                  </div>\r\n                </div>\r\n                {/* Display images if available - simplified, no extras */}\r\n                {message.sender === 'assistant' && message.images && Array.isArray(message.images) && message.images.length > 0 && (\r\n                  <div className=\"flex flex-col gap-2 mt-2\">\r\n                    {message.images.map((img, idx) => {\r\n                      if (!img || !img.url) {\r\n                        console.warn('Invalid image object:', img);\r\n                        return null;\r\n                      }\r\n                      \r\n                      // Ensure URL is properly formatted\r\n                      let imageUrl = String(img.url).trim();\r\n                      if (!imageUrl) {\r\n                        return null;\r\n                      }\r\n                      \r\n                      // Ensure URL starts with / for proper path resolution\r\n                      if (!imageUrl.startsWith('/') && !imageUrl.startsWith('http')) {\r\n                        imageUrl = '/' + imageUrl;\r\n                      }\r\n                      \r\n                      console.log('üñºÔ∏è Rendering image:', { idx, imageUrl, messageId: message.id });\r\n                      \r\n                      return (\r\n                        <img\r\n                          key={`img-${message.id}-${idx}`}\r\n                          src={imageUrl}\r\n                          alt={img.description || img.title || 'Knowledge base image'}\r\n                          className=\"max-w-[400px] h-auto rounded-lg shadow-sm\"\r\n                          loading=\"lazy\"\r\n                          onError={(e) => {\r\n                            console.error('‚ùå Image failed to load:', imageUrl, 'Full img object:', img);\r\n                            const target = e.target as HTMLImageElement;\r\n                            target.style.border = '2px solid red';\r\n                            target.alt = 'Failed to load: ' + imageUrl;\r\n                          }}\r\n                          onLoad={() => {\r\n                            console.log('‚úÖ Image loaded successfully:', imageUrl);\r\n                          }}\r\n                        />\r\n                      );\r\n                    })}\r\n                  </div>\r\n                )}\r\n               </div>\r\n              {message.sender === 'user' && (\r\n                <div className=\"bg-center bg-no-repeat aspect-square bg-cover rounded-full w-12 shrink-0 relative overflow-hidden flex items-center justify-center\" style={{ background: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', boxShadow: '0 8px 30px rgba(79, 172, 254, 0.3)' }}>\r\n                  <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent\"></div>\r\n                  <span className=\"material-symbols-outlined text-white relative z-10 text-xl\">person</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n\r\n          {isLoading && (\r\n            <div className=\"flex items-end gap-3\">\r\n              <div className=\"bg-center bg-no-repeat aspect-square bg-cover rounded-full w-12 shrink-0 relative overflow-hidden flex items-center justify-center\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', boxShadow: '0 8px 30px rgba(102, 126, 234, 0.3)' }}>\r\n                <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent\"></div>\r\n                <span className=\"material-symbols-outlined text-white relative z-10 text-xl\">support_agent</span>\r\n              </div>\r\n              <div className=\"flex items-center justify-center rounded-2xl rounded-bl-none px-5 py-4 glass-card\" style={{ background: 'rgba(255, 255, 255, 0.4)', backdropFilter: 'blur(15px)' }}>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"size-2 rounded-full animate-[pulse_1.5s_cubic-bezier(0.4,0,0.6,1)_infinite]\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}></span>\r\n                  <span className=\"size-2 rounded-full animate-[pulse_1.5s_cubic-bezier(0.4,0,0.6,1)_infinite_0.2s]\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}></span>\r\n                  <span className=\"size-2 rounded-full animate-[pulse_1.5s_cubic-bezier(0.4,0,0.6,1)_infinite_0.4s]\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}></span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {sources.length > 0 && (\r\n            <div className=\"flex flex-col gap-3 ml-12\">\r\n              <h3 className=\"text-charcoal/80 text-sm font-bold leading-tight tracking-[-0.015em] px-1 pt-2\">\r\n                Sources\r\n              </h3>\r\n              <div className=\"flex flex-col items-stretch justify-start rounded-2xl glass-card overflow-hidden animate-slide-up\" style={{ background: 'rgba(255, 255, 255, 0.4)', backdropFilter: 'blur(15px)', border: '1px solid rgba(255, 255, 255, 0.3)' }}>\r\n                {sources.map((source, index) => (\r\n                  <div\r\n                    key={index}\r\n                    className={`flex w-full min-w-72 grow flex-col items-stretch justify-center gap-2 p-4 ${\r\n                      index < sources.length - 1 ? 'border-b border-soft-gray/50' : ''\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"flex items-center justify-center size-7 rounded-full font-semibold text-xs text-white relative overflow-hidden\" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', boxShadow: '0 4px 15px rgba(102, 126, 234, 0.3)' }}>\r\n                        <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent\"></div>\r\n                        <span className=\"relative z-10\">{index + 1}</span>\r\n                      </div>\r\n                      <p className=\"text-primary text-sm font-semibold leading-normal flex-1\">\r\n                        {source.title}\r\n                      </p>\r\n                    </div>\r\n                    <p className=\"text-charcoal text-sm font-normal leading-normal pl-9\">\r\n                      {source.snippet}\r\n                    </p>\r\n                    <div className=\"flex items-end gap-3 justify-end pt-1\">\r\n                      <button className=\"flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden h-9 px-4 text-charcoal text-sm font-medium leading-normal rounded-xl hover-lift transition-all\" style={{ background: 'rgba(255, 255, 255, 0.3)', backdropFilter: 'blur(10px)' }}>\r\n                        <span className=\"truncate\">View document</span>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n           <div ref={messagesEndRef} style={{ height: '1px' }} />\r\n         </main>\r\n\r\n        <footer className=\"absolute bottom-0 left-0 right-0 glass-card\" style={{ background: 'rgba(255, 255, 255, 0.3)', backdropFilter: 'blur(20px)', borderTop: '1px solid rgba(255, 255, 255, 0.18)' }}>\r\n          <div className=\"flex items-center gap-3 p-4\">\r\n            <input\r\n              value={inputMessage}\r\n              onChange={(e) => setInputMessage(e.target.value)}\r\n              onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\r\n              className=\"modern-input w-full rounded-2xl py-4 px-5 text-charcoal placeholder-charcoal/60\"\r\n              placeholder=\"Ask about exams, timetables, admissions...\"\r\n              type=\"text\"\r\n            />\r\n            <button\r\n              onClick={handleSendMessage}\r\n              disabled={isLoading}\r\n              className=\"btn-primary flex h-14 w-14 shrink-0 items-center justify-center rounded-2xl text-white relative overflow-hidden group disabled:opacity-50\"\r\n              style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}\r\n            >\r\n              <span className=\"material-symbols-outlined relative z-10\">send</span>\r\n              <div className=\"absolute inset-0 bg-gradient-to-r from-purple-600 to-blue-600 opacity-0 group-hover:opacity-100 transition-opacity\"></div>\r\n            </button>\r\n          </div>\r\n        </footer>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AA+BA;;CAEC,GACD,SAAS,qBAAqB,OAAe;IAC3C,wCAAwC;IACxC,MAAM,aAAa,QAAQ,KAAK,CAAC,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,IAAI;IAE5D,OAAO,WAAW,GAAG,CAAC,CAAC,WAAW;QAChC,MAAM,UAAU,UAAU,IAAI;QAE9B,qDAAqD;QACrD,IAAI,WAAW,IAAI,CAAC,YAAY,aAAa,IAAI,CAAC,UAAU;YAC1D,MAAM,YAAY,QAAQ,KAAK,CAAC,iBAAiB,MAAM,CAAC,CAAA,OAAQ,KAAK,IAAI;YACzE,qBACE,8OAAC;gBAAa,WAAU;0BACrB,UAAU,GAAG,CAAC,CAAC,MAAM;oBACpB,MAAM,YAAY,KAAK,OAAO,CAAC,uBAAuB,IAAI,IAAI;oBAC9D,qBACE,8OAAC;wBAAiB,WAAU;;0CAC1B,8OAAC;gCAAK,WAAU;0CAAmC;;;;;;0CACnD,8OAAC;gCAAK,WAAU;0CAAU;;;;;;;uBAFnB;;;;;gBAKb;eATO;;;;;QAYb;QAEA,oBAAoB;QACpB,MAAM,QAAQ,QAAQ,KAAK,CAAC,MAAM,MAAM,CAAC,CAAA,OAAQ,KAAK,IAAI;QAC1D,qBACE,8OAAC;YAAY,WAAU;sBACpB,MAAM,GAAG,CAAC,CAAC,MAAM,wBAChB,8OAAC;;wBACE,KAAK,IAAI;wBACT,UAAU,MAAM,MAAM,GAAG,mBAAK,8OAAC;4BAAG,WAAU;;;;;;;mBAFpC;;;;;WAFP;;;;;IASZ;AACF;AACe,SAAS;IACtB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAiB,EAAE;IACrE,MAAM,CAAC,uBAAuB,yBAAyB,GAAG,IAAA,iNAAQ,EAAiB,EAAE;IACrF,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,iNAAQ,EAAsB;IAClF,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAY,EAAE;IACtD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAW,EAAE;IACnD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAC;IACzD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,wBAAwB,0BAA0B,GAAG,IAAA,iNAAQ,EAAgB;IACpF,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAA6C;IACzF,MAAM,iBAAiB,IAAA,+MAAM,EAAiB;IAC9C,MAAM,uBAAuB,IAAA,+MAAM,EAAiB;IACpD,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACR,8DAA8D;QAC9D,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,MAAM,eAAe,aAAa,OAAO,CAAC;QAC1C,MAAM,kBAAkB,aAAa,OAAO,CAAC,sBAAsB;QACnE,MAAM,iBAAiB,aAAa,OAAO,CAAC,qBAAqB;QAEjE,8DAA8D;QAC9D,IAAI,eAAe,UAAU,CAAC,cAAc;YAC1C,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YACxB,OAAO,IAAI,CAAC;YACZ;QACF;QACA,gBAAgB;QAChB,cAAc;YAAE,OAAO;YAAiB,UAAU;QAAe;QACjE;IACF,GAAG;QAAC;KAAO;IAEX,6CAA6C;IAC7C,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,YAAY,IAAI,IAAI;YACvB,yBAAyB;QAC3B,OAAO;YACL,MAAM,QAAQ,YAAY,WAAW;YACrC,MAAM,WAAW,cAAc,MAAM,CAAC,CAAC,OACrC,KAAK,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC;YAEpC,yBAAyB;QAC3B;IACF,GAAG;QAAC;QAAa;KAAc;IAE/B,IAAA,kNAAS,EAAC;QACR,IAAI,oBAAoB;YACtB,yBAAyB,mBAAmB,EAAE;QAChD;IACF,GAAG;QAAC;KAAmB;IAEvB,IAAA,kNAAS,EAAC;QACR,wCAAwC;QACxC,MAAM,YAAY,WAAW;YAC3B;QACF,GAAG;QACH,OAAO,IAAM,aAAa;IAC5B,GAAG;QAAC;QAAU;KAAU;IAExB,MAAM,iBAAiB;QACrB,8CAA8C;QAC9C,sBAAsB;YACpB,MAAM,YAAY,qBAAqB,OAAO;YAC9C,IAAI,WAAW;gBACb,+BAA+B;gBAC/B,UAAU,SAAS,GAAG,UAAU,YAAY;YAC9C;YACA,sCAAsC;YACtC,IAAI,eAAe,OAAO,EAAE;gBAC1B,eAAe,OAAO,CAAC,cAAc,CAAC;oBAAE,UAAU;oBAAU,OAAO;gBAAM;YAC3E;QACF;IACF;IAEA,MAAM,oBAAoB;QACxB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM;YACxB,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,MAAM,OAAO,MAAM,OAAO,CAAC,QAAQ,OAAO,EAAE;YAC5C,iBAAiB;YACjB,yBAAyB;YACzB,IAAI,KAAK,MAAM,GAAG,KAAK,CAAC,oBAAoB;gBAC1C,sBAAsB,IAAI,CAAC,EAAE;YAC/B;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iCAAiC;QACjD;IACF;IAEA,MAAM,2BAA2B,OAAO;QACtC,MAAM,YAAY,OAAO,OAAO,CAAC;QACjC,IAAI,CAAC,WAAW;QAEhB,IAAI;YACF,0BAA0B;YAC1B,MAAM,MAAM,MAAM,MAAM,CAAC,mBAAmB,EAAE,gBAAgB,EAAE;gBAC9D,QAAQ;YACV;YAEA,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,YAAY,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;wBAAE,OAAO;oBAAgC,CAAC;gBAC1F,MAAM,IAAI,MAAM,UAAU,KAAK,IAAI,CAAC,cAAc,EAAE,IAAI,MAAM,EAAE;YAClE;YAEA,iBAAiB,CAAC;gBAChB,MAAM,UAAU,KAAK,MAAM,CAAC,CAAC,OAAS,KAAK,EAAE,KAAK;gBAClD,MAAM,gBAAgB,oBAAoB,OAAO;gBAEjD,IAAI,eAAe;oBACjB,MAAM,aAAa,OAAO,CAAC,EAAE,IAAI;oBACjC,sBAAsB;oBAEtB,IAAI,YAAY;wBACd,yBAAyB,WAAW,EAAE;oBACxC,OAAO;wBACL,YAAY,EAAE;wBACd,WAAW,EAAE;oBACf;gBACF;gBAEA,OAAO;YACT;YACA,wDAAwD;YACxD;QACF,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,kCAAkC;YAChD,MAAM,MAAM,OAAO,IAAI;QACzB,SAAU;YACR,0BAA0B;QAC5B;IACF;IAEA,MAAM,2BAA2B,OAAO;QACtC,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,mBAAmB,EAAE,gBAAgB;YAC9D,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,2DAA2D;YAC3D,MAAM,oBAAoB,CAAC,KAAK,QAAQ,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC;gBACnD,IAAI,SAAS;gBAEb,mFAAmF;gBACnF,IAAI,IAAI,MAAM,EAAE;oBACd,IAAI,OAAO,IAAI,MAAM,KAAK,UAAU;wBAClC,IAAI;4BACF,SAAS,KAAK,KAAK,CAAC,IAAI,MAAM;wBAChC,EAAE,OAAO,GAAG;4BACV,QAAQ,IAAI,CAAC,gCAAgC;4BAC7C,SAAS;wBACX;oBACF,OAAO,IAAI,MAAM,OAAO,CAAC,IAAI,MAAM,GAAG;wBACpC,SAAS,IAAI,MAAM;oBACrB;oBAEA,sBAAsB;oBACtB,IAAI,UAAU,MAAM,OAAO,CAAC,WAAW,OAAO,MAAM,GAAG,GAAG;wBACxD,SAAS,OAAO,MAAM,CAAC,CAAC,MAAa,OAAO,IAAI,GAAG,IAAI,OAAO,IAAI,GAAG,KAAK,YAAY,IAAI,GAAG,CAAC,IAAI,GAAG,MAAM,GAAG;wBAC9G,IAAI,OAAO,MAAM,KAAK,GAAG;4BACvB,SAAS;wBACX;oBACF,OAAO;wBACL,SAAS;oBACX;gBACF;gBAEA,OAAO;oBACL,GAAG,GAAG;oBACN;gBACF;YACF;YAEA,QAAQ,GAAG,CAAC,mCAAmC,kBAAkB,MAAM,CAAC,CAAC,IAAW,EAAE,MAAM,EAAE,MAAM;YACpG,YAAY;YACZ,WAAW,EAAE;YACb,0CAA0C;YAC1C,WAAW,IAAM,kBAAkB;QACrC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;QAC5C;IACF;IAEA,MAAM,oBAAoB;QACxB,IAAI,CAAC,aAAa,IAAI,MAAM,WAAW;QAEvC,MAAM,cAAc,aAAa,IAAI;QACrC,gBAAgB;QAChB,aAAa;QAEb,qCAAqC;QACrC,MAAM,kBAA2B;YAC/B,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;YACxB,QAAQ;YACR,SAAS;YACT,WAAW,IAAI,OAAO,WAAW;QACnC;QACA,YAAY,CAAA,OAAQ;mBAAI;gBAAM;aAAgB;QAE9C,mCAAmC;QACnC,WAAW,IAAM,kBAAkB;QAEnC,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,aAAa;gBACnC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,SAAS;oBACT,gBAAgB,oBAAoB;gBACtC;YACF;YAEC,IAAI,CAAC,IAAI,EAAE,EAAE;gBACZ,MAAM,YAAY,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;wBAAE,OAAO;oBAAyB,CAAC;gBACnF,MAAM,IAAI,MAAM,UAAU,KAAK,IAAI,CAAC,cAAc,EAAE,IAAI,MAAM,EAAE;YAClE;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,CAAC,KAAK,MAAM,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,4CAA4C;YAC5C,YAAY,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,gBAAgB,EAAE;YAEhE,+CAA+C;YAC/C,YAAY,CAAA,OAAQ;uBAAI;oBAAM;iBAAgB;YAE9C,kDAAkD;YAClD,QAAQ,GAAG,CAAC,2BAA2B;gBACrC,WAAW,CAAC,CAAC,KAAK,MAAM;gBACxB,WAAW,CAAC,CAAC,KAAK,MAAM;gBACxB,YAAY,KAAK,MAAM,EAAE,UAAU;gBACnC,QAAQ,KAAK,MAAM;YACrB;YAEA,yCAAyC;YACzC,IAAI,kBAAkB;YACtB,IAAI,KAAK,MAAM,IAAI,MAAM,OAAO,CAAC,KAAK,MAAM,KAAK,KAAK,MAAM,CAAC,MAAM,GAAG,GAAG;gBACvE,kBAAkB,KAAK,MAAM,CAC1B,MAAM,CAAC,CAAC;oBACP,MAAM,UAAU,OAAO,IAAI,GAAG,IAAI,OAAO,IAAI,GAAG,KAAK,YAAY,IAAI,GAAG,CAAC,IAAI,GAAG,MAAM,GAAG;oBACzF,IAAI,CAAC,SAAS;wBACZ,QAAQ,IAAI,CAAC,sCAAsC;oBACrD;oBACA,OAAO;gBACT,GACC,GAAG,CAAC,CAAC,MAAa,CAAC;wBAClB,KAAK,IAAI,GAAG,CAAC,IAAI;wBACjB,aAAa,IAAI,WAAW,IAAI,IAAI,KAAK,IAAI;wBAC7C,OAAO,IAAI,KAAK,IAAI;oBACtB,CAAC;gBACH,IAAI,gBAAgB,MAAM,KAAK,GAAG;oBAChC,kBAAkB;gBACpB,OAAO;oBACL,QAAQ,GAAG,CAAC,mCAAmC;gBACjD;YACF,OAAO;gBACL,QAAQ,GAAG,CAAC;YACd;YAEA,MAAM,mBAA4B;gBAChC,IAAI,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI;gBACvB,QAAQ;gBACR,SAAS,KAAK,MAAM,IAAI;gBACxB,WAAW,IAAI,OAAO,WAAW;gBACjC,QAAQ;YACV;YAEA,QAAQ,GAAG,CAAC,iCAAiC;gBAC3C,WAAW,CAAC,CAAC,iBAAiB,MAAM;gBACpC,YAAY,iBAAiB,MAAM,EAAE,UAAU;gBAC/C,WAAW,iBAAiB,EAAE;gBAC9B,QAAQ,iBAAiB,MAAM;YACjC;YAEA,kDAAkD;YAClD,YAAY,CAAA;gBACV,MAAM,UAAU;uBAAI;oBAAM;iBAAiB;gBAC3C,QAAQ,GAAG,CAAC,6BAA6B,QAAQ,MAAM,EAAE,kCAAkC,CAAC,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,EAAE,CAAC,MAAM;gBAC/H,OAAO;YACT;YAEA,2BAA2B;YAC1B,IAAI,KAAK,OAAO,IAAI,MAAM,OAAO,CAAC,KAAK,OAAO,GAAG;gBAChD,WAAW,KAAK,OAAO;YACzB,OAAO;gBACL,WAAW,EAAE;YACf;YAEA,+CAA+C;YAC/C,WAAW,IAAM,kBAAkB;YAElC,6BAA6B;YAC9B,IAAI,KAAK,cAAc,EAAE;gBACvB,MAAM,cAA4B;oBAChC,IAAI,KAAK,cAAc;oBACvB,OAAO,oBAAoB,SAAS,YAAY,SAAS,CAAC,GAAG;oBAC7D,WAAW,IAAI,OAAO,WAAW;gBACnC;gBACA,sBAAsB;gBACtB;YACF;QACD,EAAE,OAAO,OAAY;YACpB,QAAQ,KAAK,CAAC,2BAA2B;YAEzC,oCAAoC;YACpC,YAAY,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,gBAAgB,EAAE;YAEhE,oBAAoB;YACpB,MAAM,eAAwB;gBAC5B,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,IAAI;gBACzB,QAAQ;gBACR,SAAS,CAAC,+BAA+B,EAAE,MAAM,OAAO,IAAI,gBAAgB,mBAAmB,CAAC;gBAChG,WAAW,IAAI,OAAO,WAAW;YACnC;YACA,YAAY,CAAA,OAAQ;uBAAI;oBAAM;iBAAa;YAC3C,WAAW,IAAM,kBAAkB;QACpC,SAAU;YACT,aAAa;QACf;IACF;IAEA,MAAM,wBAAwB,CAAC;QAC7B,gBAAgB;IAClB;IAEA,MAAM,wBAAwB;QAC5B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,sBAAsB;gBAC5C,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,OAAO;gBACT;YACF;YAEA,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,kBAAkB,MAAM,IAAI,IAAI;YAEtC,yBAAyB;YACzB,YAAY,EAAE;YACd,WAAW,EAAE;YAEb,iCAAiC;YACjC,sBAAsB;YAEtB,4BAA4B;YAC5B,MAAM;QACR,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,kCAAkC;YAChD,MAAM,MAAM,OAAO,IAAI;QACzB;IACF;IAEA,MAAM,aAAa;QACjB;YAAE,MAAM;YAAU,OAAO;QAAY;QACrC;YAAE,MAAM;YAAkB,OAAO;QAAY;QAC7C;YAAE,MAAM;YAAgB,OAAO;QAAO;QACtC;YAAE,MAAM;YAAiB,OAAO;QAAU;QAC1C;YAAE,MAAM;YAAO,OAAO;QAAa;QACnC;YAAE,MAAM;YAAY,OAAO;QAAW;KACvC;IAED,IAAI,CAAC,cAAc;QACjB,qBACE,8OAAC;YAAI,WAAU;YAAmD,OAAO;gBAAE,YAAY;YAAoD;sBACzI,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBAAE,WAAU;kCAA4B;;;;;;;;;;;;;;;;;IAIjD;IAEA,qBACE,8OAAC;QAAI,WAAU;QAAgD,OAAO;YAAE,YAAY;QAAoD;;0BAEtI,8OAAC;gBAAM,WAAU;gBAAwD,OAAO;oBAAE,YAAY;oBAA6B,gBAAgB;oBAAc,aAAa;gBAA4B;;kCAChM,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;wCAAgG,OAAO;4CAAE,YAAY;4CAAqD,WAAW;wCAAsC;;0DACxO,8OAAC;gDAAI,WAAU;;;;;;0DACf,8OAAC;gDAAE,WAAU;0DAA6C;;;;;;;;;;;;kDAE5D,8OAAC;wCAAE,WAAU;wCAAgD,OAAO;4CAAE,YAAY;4CAAqD,sBAAsB;4CAAQ,qBAAqB;wCAAc;kDAAG;;;;;;;;;;;;0CAE7M,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAA+G;;;;;;kDAG/H,8OAAC;wCACC,WAAU;wCACV,aAAY;wCACZ,MAAK;wCACL,OAAO;wCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;;;;;;;kCAIpD,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;;kDACC,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAG,WAAU;0DAAkE;;;;;;0DAGhF,8OAAC;gDACC,SAAS;gDACT,WAAU;gDACV,OAAO;oDAAE,YAAY;oDAAqD,WAAW;gDAAsC;gDAC3H,OAAM;0DAEN,cAAA,8OAAC;oDAAK,WAAU;8DAAsC;;;;;;;;;;;;;;;;;kDAG1D,8OAAC;wCAAG,WAAU;kDACX,sBAAsB,MAAM,KAAK,KAAK,4BACrC,8OAAC;4CAAG,WAAU;;gDAAiD;gDAC3B;gDAAY;;;;;;mDAGhD,sBAAsB,GAAG,CAAC,CAAC,qBAC3B,8OAAC;gDAEC,SAAS,IAAM,sBAAsB;gDACrC,WAAW,CAAC,sFAAsF,EAChG,oBAAoB,OAAO,KAAK,EAAE,GAC9B,mBACA,qBACJ;gDACF,OAAO,oBAAoB,OAAO,KAAK,EAAE,GAAG;oDAAE,YAAY;oDAA6B,WAAW;gDAA2F,IAAI,CAAC;;kEAElM,8OAAC;wDACC,WAAW,CAAC,sCAAsC,EAChD,oBAAoB,OAAO,KAAK,EAAE,GAAG,iBAAiB,oBACtD;kEACH;;;;;;kEAGD,8OAAC;wDAAI,WAAU;kEACb,cAAA,8OAAC;4DACC,WAAW,CAAC,+BAA+B,EACzC,oBAAoB,OAAO,KAAK,EAAE,GAC9B,+BACA,6BACJ;sEAED,KAAK,KAAK;;;;;;;;;;;kEAGf,8OAAC;wDACC,SAAS,CAAC;4DACR,EAAE,eAAe;4DACjB,yBAAyB,KAAK,EAAE;wDAClC;wDACA,UAAU,2BAA2B,KAAK,EAAE;wDAC5C,WAAU;wDACV,OAAM;kEAEN,cAAA,8OAAC;4DAAK,WAAU;sEAAwC;;;;;;;;;;;;+CApCrD,KAAK,EAAE;;;;;;;;;;;;;;;;0CA2CpB,8OAAC;;kDACC,8OAAC;wCAAG,WAAU;kDAA4E;;;;;;kDAG1F,8OAAC;wCAAG,WAAU;kDACX,WAAW,GAAG,CAAC,CAAC,qBACf,8OAAC;gDAEC,WAAU;;kEAEV,8OAAC;wDAAK,WAAU;kEACb,KAAK,IAAI;;;;;;kEAEZ,8OAAC;wDAAE,WAAU;kEACV,KAAK,KAAK;;;;;;;+CAPR,KAAK,KAAK;;;;;;;;;;;;;;;;;;;;;;kCAezB,8OAAC;wBAAI,WAAU;wBAAe,OAAO;4BAAE,aAAa;wBAA4B;;0CAC9E,8OAAC;gCAAI,WAAU;gCAAiC,OAAO;oCAAE,YAAY;oCAA4B,gBAAgB;gCAAa;;kDAC5H,8OAAC;wCAAE,WAAU;kDAA6B;;;;;;kDAC1C,8OAAC;wCAAE,WAAU;kDAAgD,YAAY,SAAS;;;;;;oCACjF,YAAY,0BACX,8OAAC;wCAAE,WAAU;kDAAyC,WAAW,QAAQ;;;;;;;;;;;;0CAG7E,8OAAC,uKAAI;gCACH,MAAK;gCACL,WAAU;gCACV,OAAO;oCAAE,YAAY;oCAAqD,WAAW;gCAAsC;;kDAE3H,8OAAC;wCAAK,WAAU;kDAAoC;;;;;;kDACpD,8OAAC;kDAAK;;;;;;;;;;;;;;;;;;;;;;;;0BAMZ,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAO,WAAU;wBAA4D,OAAO;4BAAE,YAAY;4BAA4B,gBAAgB;4BAAc,cAAc;wBAAsC;;0CAC/M,8OAAC;gCAAO,WAAU;0CAChB,cAAA,8OAAC;oCAAK,WAAU;8CAAqC;;;;;;;;;;;0CAEvD,8OAAC;gCAAG,WAAU;gCAA8D,OAAO;oCAAE,YAAY;oCAAqD,sBAAsB;oCAAQ,qBAAqB;gCAAc;0CACpN,oBAAoB,SAAS;;;;;;0CAEhC,8OAAC;gCAAI,WAAU;;;;;;;;;;;;kCAGjB,8OAAC;wBACC,KAAK;wBACJ,WAAU;wBACX,OAAO;4BACL,WAAW;4BACX,gBAAgB;4BAChB,yBAAyB;wBAC3B;;4BAEC,kCACC,8OAAC;gCAAI,WAAU;gCAAgF,OAAO;oCAAE,YAAY;oCAA4B,gBAAgB;oCAAc,QAAQ;gCAAqC;;kDACzN,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAE,WAAU;0DAAoD;;;;;;0DAGjE,8OAAC;gDAAE,WAAU;0DAAmD;;;;;;;;;;;;kDAIlE,8OAAC;wCACC,SAAS,IAAM,oBAAoB;wCACnC,WAAU;kDACX;;;;;;;;;;;;4BAMJ,SAAS,MAAM,KAAK,mBACnB,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;wCAAmJ,OAAO;4CAAE,YAAY;4CAAqD,WAAW;wCAAsC;;0DAC3R,8OAAC;gDAAI,WAAU;;;;;;0DACf,8OAAC;gDAAK,WAAU;0DAA8D;;;;;;;;;;;;kDAEhF,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAE,WAAU;0DAAwE;;;;;;0DAGrF,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDAAE,WAAU;kEAAoI;;;;;;kEAGjJ,8OAAC;wDAAI,WAAU;;0EACb,8OAAC;gEACC,SAAS,IAAM,sBAAsB;gEACrC,WAAU;gEACV,OAAO;oEAAE,YAAY;oEAA4B,gBAAgB;gEAAa;0EAC/E;;;;;;0EAGD,8OAAC;gEACC,SAAS,IAAM,sBAAsB;gEACrC,WAAU;gEACV,OAAO;oEAAE,YAAY;oEAA4B,gBAAgB;gEAAa;0EAC/E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BASV,SAAS,GAAG,CAAC,CAAC,wBACb,8OAAC;oCAEC,WAAW,CAAC,qBAAqB,EAAE,QAAQ,MAAM,KAAK,SAAS,gBAAgB,IAAI;;wCAElF,QAAQ,MAAM,KAAK,6BAClB,8OAAC;4CAAI,WAAU;4CAAqI,OAAO;gDAAE,YAAY;gDAAqD,WAAW;4CAAsC;;8DAC7Q,8OAAC;oDAAI,WAAU;;;;;;8DACf,8OAAC;oDAAK,WAAU;8DAA6D;;;;;;;;;;;;sDAGjF,8OAAC;4CACC,WAAW,CAAC,mCAAmC,EAAE,QAAQ,MAAM,KAAK,SAAS,QAAQ,SAAS;;8DAE9F,8OAAC;oDACC,WAAW,CAAC,sEAAsE,EAChF,QAAQ,MAAM,KAAK,SAAS,eAAe,IAC3C;8DAED,QAAQ,MAAM,KAAK,SAAS,QAAQ;;;;;;8DAEtC,8OAAC;oDACA,WAAW,CAAC,wHAAwH,EACjI,QAAQ,MAAM,KAAK,SAChB,gDACA,uDACJ;oDACD,OAAO,QAAQ,MAAM,KAAK,SAAS;wDAAE,YAAY;wDAAqD,WAAW;oDAAuC,IAAI;wDAAE,YAAY;oDAAM;8DAEjL,cAAA,8OAAC;wDAAI,WAAU;kEACZ,qBAAqB,QAAQ,OAAO;;;;;;;;;;;gDAIxC,QAAQ,MAAM,KAAK,eAAe,QAAQ,MAAM,IAAI,MAAM,OAAO,CAAC,QAAQ,MAAM,KAAK,QAAQ,MAAM,CAAC,MAAM,GAAG,mBAC5G,8OAAC;oDAAI,WAAU;8DACZ,QAAQ,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK;wDACxB,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,EAAE;4DACpB,QAAQ,IAAI,CAAC,yBAAyB;4DACtC,OAAO;wDACT;wDAEA,mCAAmC;wDACnC,IAAI,WAAW,OAAO,IAAI,GAAG,EAAE,IAAI;wDACnC,IAAI,CAAC,UAAU;4DACb,OAAO;wDACT;wDAEA,sDAAsD;wDACtD,IAAI,CAAC,SAAS,UAAU,CAAC,QAAQ,CAAC,SAAS,UAAU,CAAC,SAAS;4DAC7D,WAAW,MAAM;wDACnB;wDAEA,QAAQ,GAAG,CAAC,wBAAwB;4DAAE;4DAAK;4DAAU,WAAW,QAAQ,EAAE;wDAAC;wDAE3E,qBACE,8OAAC;4DAEC,KAAK;4DACL,KAAK,IAAI,WAAW,IAAI,IAAI,KAAK,IAAI;4DACrC,WAAU;4DACV,SAAQ;4DACR,SAAS,CAAC;gEACR,QAAQ,KAAK,CAAC,2BAA2B,UAAU,oBAAoB;gEACvE,MAAM,SAAS,EAAE,MAAM;gEACvB,OAAO,KAAK,CAAC,MAAM,GAAG;gEACtB,OAAO,GAAG,GAAG,qBAAqB;4DACpC;4DACA,QAAQ;gEACN,QAAQ,GAAG,CAAC,gCAAgC;4DAC9C;2DAbK,CAAC,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC,EAAE,KAAK;;;;;oDAgBrC;;;;;;;;;;;;wCAIL,QAAQ,MAAM,KAAK,wBAClB,8OAAC;4CAAI,WAAU;4CAAqI,OAAO;gDAAE,YAAY;gDAAqD,WAAW;4CAAqC;;8DAC5Q,8OAAC;oDAAI,WAAU;;;;;;8DACf,8OAAC;oDAAK,WAAU;8DAA6D;;;;;;;;;;;;;mCA9E5E,QAAQ,EAAE;;;;;4BAoFlB,2BACC,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;wCAAqI,OAAO;4CAAE,YAAY;4CAAqD,WAAW;wCAAsC;;0DAC7Q,8OAAC;gDAAI,WAAU;;;;;;0DACf,8OAAC;gDAAK,WAAU;0DAA6D;;;;;;;;;;;;kDAE/E,8OAAC;wCAAI,WAAU;wCAAoF,OAAO;4CAAE,YAAY;4CAA4B,gBAAgB;wCAAa;kDAC/K,cAAA,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAK,WAAU;oDAA8E,OAAO;wDAAE,YAAY;oDAAoD;;;;;;8DACvK,8OAAC;oDAAK,WAAU;oDAAmF,OAAO;wDAAE,YAAY;oDAAoD;;;;;;8DAC5K,8OAAC;oDAAK,WAAU;oDAAmF,OAAO;wDAAE,YAAY;oDAAoD;;;;;;;;;;;;;;;;;;;;;;;4BAMnL,QAAQ,MAAM,GAAG,mBAChB,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;kDAAiF;;;;;;kDAG/F,8OAAC;wCAAI,WAAU;wCAAoG,OAAO;4CAAE,YAAY;4CAA4B,gBAAgB;4CAAc,QAAQ;wCAAqC;kDAC5O,QAAQ,GAAG,CAAC,CAAC,QAAQ,sBACpB,8OAAC;gDAEC,WAAW,CAAC,0EAA0E,EACpF,QAAQ,QAAQ,MAAM,GAAG,IAAI,iCAAiC,IAC9D;;kEAEF,8OAAC;wDAAI,WAAU;;0EACb,8OAAC;gEAAI,WAAU;gEAAiH,OAAO;oEAAE,YAAY;oEAAqD,WAAW;gEAAsC;;kFACzP,8OAAC;wEAAI,WAAU;;;;;;kFACf,8OAAC;wEAAK,WAAU;kFAAiB,QAAQ;;;;;;;;;;;;0EAE3C,8OAAC;gEAAE,WAAU;0EACV,OAAO,KAAK;;;;;;;;;;;;kEAGjB,8OAAC;wDAAE,WAAU;kEACV,OAAO,OAAO;;;;;;kEAEjB,8OAAC;wDAAI,WAAU;kEACb,cAAA,8OAAC;4DAAO,WAAU;4DAA8K,OAAO;gEAAE,YAAY;gEAA4B,gBAAgB;4DAAa;sEAC5Q,cAAA,8OAAC;gEAAK,WAAU;0EAAW;;;;;;;;;;;;;;;;;+CAnB1B;;;;;;;;;;;;;;;;0CA4Bd,8OAAC;gCAAI,KAAK;gCAAgB,OAAO;oCAAE,QAAQ;gCAAM;;;;;;;;;;;;kCAGpD,8OAAC;wBAAO,WAAU;wBAA8C,OAAO;4BAAE,YAAY;4BAA4B,gBAAgB;4BAAc,WAAW;wBAAsC;kCAC9L,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;oCAC/C,YAAY,CAAC,IAAM,EAAE,GAAG,KAAK,WAAW;oCACxC,WAAU;oCACV,aAAY;oCACZ,MAAK;;;;;;8CAEP,8OAAC;oCACC,SAAS;oCACT,UAAU;oCACV,WAAU;oCACV,OAAO;wCAAE,YAAY;oCAAoD;;sDAEzE,8OAAC;4CAAK,WAAU;sDAA0C;;;;;;sDAC1D,8OAAC;4CAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO7B"}}]
}